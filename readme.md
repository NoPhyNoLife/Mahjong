# readme.md

AI Mahjong Assistant

一个快速反应的 AI 麻将助手，能够在输入当前手牌和对局进程信息后，输出建议动作（吃、碰、杠、打牌等），帮助你更好地进行麻将决策。
该项目示例使用了 Python 语言、基于启发式 + 搜索的方式来实现最初级的决策逻辑，并提供了一个可视化的 GUI 原型（基于 PyQt5）供用户友好地进行操作。

目录
	•	功能特点
	•	项目结构
	•	安装与环境
    •	语言与标记
	•	快速使用
	•	GUI 使用
	•	主要模块介绍
	•	StateManager
	•	RuleEngine
	•	DecisionMaker
	•	后续改进思路
	•	许可证

功能特点
	1.	AI 决策(还未实现，尴尬)
	•	结合手牌和当前场面信息，提示吃、碰、杠、胡或打牌等最优操作（基于简单启发式算法）。
	•	提供可扩展的决策框架，后续可加入蒙特卡洛搜索或强化学习。
	2.	实时应答
	•	快速更新：玩家在输入对手出牌或自己摸牌后，系统迅速给出建议。
	3.	图形界面（还未实现，尴尬x2）
	•	使用 PyQt5 提供简单的可视化界面示例，支持鼠标点击进行出牌与操作选择。
	4.	模块化设计
	•	规则判定、数据管理、决策逻辑和 GUI 明确分离，方便后续维护和扩展。

项目结构

项目结构如下（也可能在进一步开发中进行调整）：

<pre>
```bash
Mahjong
├── LICENSE
├── decision_maker.py
├── deck_counter.py
├── mahjongGUI.py
├── main.py
├── readme.md
├── resources
│   ├── deck
│   └── tile_codes.json
├── requirements.txt
├── rule_engine.py
├── state_manager.py
├── structure.txt
└── tile_loader.py
```
</pre>


	•	main.py：命令行模式下的示例入口，接受用户输入后调用决策模块并打印结果。
	•	mahjongGUI.py：图形界面入口，启动 PyQt 窗口进行可视化交互。（Broken）
	•	state_manager.py：维护玩家手牌、已弃牌、风圈、剩余牌山等信息。
	•	rule_engine.py：麻将规则的判定方法，如吃、碰、杠、胡牌、向听数计算等。
	•	decision_maker.py：核心 AI 策略实现，包含候选动作生成、状态模拟、评估与选择等逻辑。（Broken）
	•	resources/：用于存放牌面资源，以后可在 GUI 中显示。

安装与环境
	1.	操作系统：Windows、macOS、Linux 均可。
	2.	Python 版本：推荐 3.7+ 及以上。
	3.	依赖安装：请确保已安装以下依赖：

pip install -r requirements.txt


语言与标记

我所使用的牌面标记规则如下：
1. 玩家方位标记
player_id 是当前玩家：
    本家为0，
    上家为3，
    下家为1，
    对家为2。

2. 牌组及其编码：（每张牌面均有四张同样的牌）
    饼系列： B1 - B9, 对应 [0,1] - [0,9] 
    万系列： W1 - W9, 对应 [1,1] - [1,9]
    条系列： T1 - T9, 对应 [2,1] - [2,9]
    “东南西北中发白”：
        东 E, 对应 [3,0]
        南 S, 对应 [4,0]
        西 W, 对应 [5,0]
        北 N, 对应 [6,0]
        中 M, 对应 [7,0]
        发 R, 对应 [8,0]
        白 B, 对应 [9,0]

其中，一些内容可以在 ./resources 中进行查询。


快速使用

1. 命令行模式

如果你希望在终端中使用这个 AI 麻将助手，可以直接运行 main.py：

python main.py

	•	可能的交互示例：
	1.	程序询问：“请输入你的初始手牌(如 W1 W2 W3… ):”
	2.	用户输入：W1 W2 W3 T3 T4 B9 B9 N N S B B6 R
	3.	程序更新手牌并等待对手出牌信息，用户输入：“1 T5” 表示玩家 ID=1 打出 T5。
	4.	程序输出 AI 建议：“AI 建议：碰或打出 S9”。(Broken)
	5.	根据提示进行下一步交互……

2. GUI 使用(Broken)

若你想体验图形界面，运行 gui_app.py：

python gui_app.py

	•	将弹出一个带有手牌、操作按钮、提示区域的窗口。
	•	可以点击手牌来进行出牌；或者点击“吃/碰/杠/胡”按钮配合选择牌组进行副露操作。
	•	每当状态有变化，界面会实时刷新并显示最新AI建议或出牌信息（具体取决于你在 gui_app.py 里实现的逻辑）。

主要模块介绍

StateManager
	•	功能：管理整个对局的状态数据：我的手牌、各家弃牌、剩余牌数等。
	•	常用方法：
	•	add_discard(player_id, tile)：记录玩家 player_id 的弃牌。
	•	以及各种查询、修改状态的基础方法。

RuleEngine
	•	功能：封装麻将的规则判定。
	•	常用接口：
	•	can_chi(hand, tile)：是否可以吃
	•	can_peng(hand, tile)：是否可以碰
	•	can_gang(hand, tile, melds)：是否可以杠
	•	can_hu(hand, tile)：是否能胡
	•	……

	在此模块中也可实现胡牌算法、计番等更进阶的功能。

DecisionMaker（Broken）
	•	功能：AI 决策模块，根据当前状态、可行操作，选出最优或接近最优的动作。
	•	核心流程：
	1.	候选动作生成：列举吃、碰、杠、胡、或打牌等可能；
	2.	模拟：对每个动作做一次“假执行”，看看结果状态如何；
	3.	评分：通过向听数/听牌张数/番数等指标给状态打分；
	4.	选最优：选择得分最高的动作并返回。

后续改进思路
	1.	更强的搜索算法：
	•	实现多层搜索或蒙特卡洛树搜索，评估长期收益，而非只看一步后的向听数。
	2.	防守/安全性策略：
	•	在 evaluate_state 中引入“危险度”概念，避免打出放铳概率高的牌。
	3.	记牌推断/牌势分析：
	•	统计对手打牌规律，推断其可能持有的牌或等待，提供更有针对性的决策。
	4.	联机/多人对战：
	•	服务器端管理牌山与玩家状态，客户端做操作与UI展示，实现在线麻将对战并接入AI机器人。
	5.	更美观的 GUI：
	•	使用 Qt Quick (QML) 或其他游戏引擎（Unity、Godot）做更炫酷的界面和动画效果。

许可证

本项目基于 [MIT License](./LICENSE) 开源，版权归 [NoPhyNoLife](https://github.com/nophynolife) 所有。

欢迎贡献：
如果你对本项目有好的想法或改进，可以直接提交 Issue 或 Pull Request，一起让这个 AI 麻将助手变得更强大、更智能！

希望新的一年在开发 AI 麻将助手的道路上一切顺利！


